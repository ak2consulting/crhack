<!DOCTYPE html>
<!--
Copyright 2011 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Author: Eric Bidelman (ericbidelman@chromium.org),
        Boris Smus
        Ernest Delgado
        Pete LePage
        Peng Ying
        Eric Bidelman
-->
<html>
<head>
  <title>HTML5 Web App Hackathon</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <script src="slides.js"></script>
</head>
<body style="display: none">

<section class='slides'>

  <!-- Your slides (<article>s) go here. Delete or comment out the
       slides below. -->

  <article class='biglogo'></article>

  <!-- INTRODUCTION -->
  <article>
    <h1>HTML5 Web App Hackathon <img src="images/HTML5_Badge_64.png" style="vertical-align:middle"></h1>
    <br>
    <p>
      Boris Smus, Ernest Delgado, Pete LePage, Peng Ying
    </p>
    <br>
    <p>
      August 1-11, 2011 (NYC, CHI, KIR, MTV)<br />
      Twitter: <a href="http://twitter.com/ChromiumDev" target="_blank">@ChromiumDev</a>
    </p>
  </article>

  <!-- AGENDA -->
  <article>
    <h3>Agenda</h3>
    <p>
      <ul class="build">
        <li>Introducing DJBreakPoint</li>
        <li>HTML5 makes building apps a breeze</li>
        <li>File APIs</li>
        <li>Messaging / realtime</li>
        <li>Audio hotness</li>
        <li>Monetization / Distribution
          <ul>
            <li>Chrome Web Store</li>
            <li>In-App Payments API for the Web</li>
          </ul>
        </li>
      </ul>
    </p>
  </article>

  <!--
   *
   * DJBreakpoint
   *
  -->
  <article class="centered">
    <h2>DJBreakpoint</h2>
    <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint">
    <p><a href="https://github.com/pengying/crhack" target="_blank">https://github.com/pengying/crhack</a></p>
  </article>

  <!--
   *
   * HTML5 makes building apps a breeze
   *
  -->
  <article class="fill">
    <h2>HTML5 makes building apps a breeze</h2>
  </article>

  <!--
   *
   * File APIs: INTRO
   *
  -->
  <article class="fill">
    <h2>File APIs</h2>
  </article>

  <!--
   *
   * File APIS: File
   *
  -->
  <article class="">
    <h3>Importing tunes: <code>File</code> / <code>FileList</code></h3>
      <pre>&lt;input type="file" <b>accept="audio/*"</b> <b>multiple</b>&gt;</pre>
      <pre>
document.querySelector('input[type="file"]').onchange = function(e) {
  var files = <b>e.target.files</b>; // FileList

  for (var i = 0, f; f = files[i]; ++i) {
    // f.name
    // f.type // mimetype
    // f.size // bytes
    // f.lastModifiedDate.toLocaleDateString()
  }
};
</pre>
    <input type="file" id="filereader-files" multiple accept="audio/*"/>
    <output id="filereader-list"></output>
  </article>
  <script>
  (function() {
    document.querySelector('#filereader-files').onchange = function(e) {
      var files = e.target.files; // FileList

      var output = [];
      for (var i = 0, f; f = files[i]; ++i) {
        output.push('<li><b>', f.name, '</b> (',
            f.type || 'n/a', ') - ', f.size, ' bytes, last modified: ',
            f.lastModifiedDate.toLocaleDateString(), '</li>');
      }
      document.querySelector('#filereader-list').innerHTML =
          '<ul>' + output.join('') + '</ul>';
    };
  })();
  </script>

  <!--
   *
   * File APIs: Directory Upload
   *
  -->
  <article id="slide-dndfiles">
    <h3>Importing a directory of tunes</h3>
      <pre class="centered">&lt;input type="file" <b>webkitdirectory</b> /&gt;</pre>
      <ul>
        <li>Files in the <code>FileList</code> will have a <code>webkitRelativePath</code> property</li>
      </ul>
      <p><iframe class="noborder" src="http://www.htmlfivewow.com/demos/directory-upload/index.html" style="height:195px;"></iframe></p>
  </article>

  <!--
   *
   * File APIS: FileReader
   *
  -->
  <article>
    <h3>Reading files: <code>FileReader</code></h3>
    <p>Asynchronously read binary data into memory:</p>
    <pre>
var reader = new <b>FileReader</b>();

reader.<b>readAsBinaryString</b>(File|Blob);

reader.<b>readAsText</b>(File|Blob, opt_encoding); // default UTF-8

reader.<b>readAsDataURL</b>(Blob|File);

reader.<b>readAsArrayBuffer</b>(Blob|File);</pre>
      <p>Reading byte ranges: <a href="http://www.html5rocks.com/tutorials/file/dndfiles/#toc-slicing-files" target="_new">Demo</a></p>
      <pre>var blob = <b>file.webkitSlice</b>(startingByte, offset, opt_contentType);
reader.<b>readAsBinaryString</b>(blob);</pre>
  </article>

  <!--
   *
   * File APIS: Monitoring a Read
   *
  -->
  <article>
    <h3>Monitoring a read</h3>
      <pre>
reader.<b>onerror</b> = errorHandler;

reader.<b>onprogress</b> = updateProgress;

reader.<b>onabort</b> = cancelRead;

reader.<b>onloadstart</b> = updateProgress;

reader.<b>onloadend</b> = function(e) {
  // <b>e.target.readyState</b> == <b>FileReader.DONE</b> == 2
};

reader.onload = readFile;</pre>
    <p><a href="http://www.html5rocks.com/tutorials/file/dndfiles/#toc-monitoring-progress" target="_new">Demo</a></p>
  </article>


  <!--
   *
   * File APIs: Drag and Drop File Access
   *
  -->
  <article id="slide-dndfiles">
    <h3>Import tunes using drag &amp; drop</h3>
  <pre>var reader = new <b>FileReader</b>();
<b>reader.onload</b> = function(e) {
  document.querySelector('img').src = <b>e.target.result</b>;
};

function onDrop(e) {
  reader.<b>readAsDataURL</b>(<b>e.dataTransfer.files[0]</b>);
};</pre>
      <div>
        <div id="dropzone">
          Drop image files from your desktop
        </div>
      </div>
      <div id="thumbnails" class="hcenter"></div>
  </article>
  <script>
  document.addEventListener('DOMContentLoaded', function(e) {
    var dndc = new DNDFileController('dropzone');
  }, false);
  </script>

  <!--
   *
   * XHR2
   *
  -->
  <article class="fill">
    <h3>XMLHttpRequest 2</h3>
    <img src="images/ajax.jpg">
  </article>

  <!--
   *
   * XHR2: Forms
   *
  -->
  <article>
    <h3>Sending form data: xhr.send(formData)</h3>
      <pre>
function submitForm() {
  var fd = new FormData(); // or prefill: FormData(window.myform)
  fd.append("username", "Groucho");
  fd.append("accountnum", 123456);

  // Append File. Creates a multipart/form-data upload.
  var file = document.querySelector('#afile').files[0];
  if (file) {
    fd.append('afile', file);
  }

  var xhr = new XMLHttpRequest();
  xhr.open('POST', '/upload', true);
  xhr.onload = function(e) { ... };
  xhr.send(fd);
}
</pre>
  </article>

  <!--
   *
   * XHR2: Blobs
   *
  -->
  <article>
    <h3>Uploading files: xhr.send(Blob|File)</h3>
      <pre>
function upload(blob, opt_callback) {
  var xhr = new XMLHttpRequest();
  xhr.open('POST', '/upload', true);
  if (opt_callback) {
    xhr.onload = opt_callback;
  }
  xhr.send(blob);
}

window.BlobBuilder = window.BlobBuilder ||
    window.WebKitBlobBuilder || window.MozBlobBuilder;

var bb = new BlobBuilder(); // Create a .txt file on the fly.
bb.append('Hello World');

uploadFile(bb.getBlob('text/plain'), function(e) {
  console.log('upload complete');
});
</pre>

  </article>

  <!--
   *
   * XHR2: Downlading
   *
  -->
  <article class="smaller">
      <h3>Download files</h3>
        <pre>
function download(url, callback) {
  var xhr = new XMLHttpRequest();
  xhr.open('GET', url, true);

  <b>xhr.responseType = 'arraybuffer';</b> // A raw buffer of bytes.

  xhr.onload = function(e) {
    callback(this, <b>this.response</b>); // Note: not xhr.responseText
  };
  xhr.send();
}

download('song.mp3', function(xhr, arrayBuffer) {
  // Create a file.
  var bb = new BlobBuilder();
  bb.append(arrayBuffer);
  var blob = bb.getBlob('audio/mpeg');

  // Create typed arrays "views" of the data buffer.
  var uInt8Array = new Uint8Array(arrayBuffer);
  var uInt32Array = new Uint32Array(arrayBuffer);
  var byte3 = uInt8Array[4]; // byte at offset 4.
});
</pre>
  </article>

  <!--
   *
   * Monetization / Distribution
   *
  -->
  <article class="fill">
    <h2>Monetization / Distribution</h2>
  </article>

  <!-- USERS -->
   <article>
   <h3>
     Transaction growth
   </h3>
   <div>
     <div class="usersbooks">
     Books<br>
     <img src="./images/books.png" height="125">
     </div>
     <div class="usersyoutube">
     YouTube<br>
     <img src="./images/youtube.png" height="125">
     </div>
     <div class="userscws">
     Chrome<br>
     Web Store<br>
     <img src="./images/cws.png" height="125">
     </div>
     <div class="usersandroidmarket">
     Android Market<br>
     <img src="./images/androidmarket.png" height="125">
    </div>
     <div style="margin-top:13%;">
     <img class="centered" src="./images/growthgraph.png">
     </div>
   </div>
   </article>

  <!-- IAP BENEFITS -->
   <article class="">
  <h3>Benefits</h3>

  <div>
    <table class="noborder">
    <tbody><tr class="build">
      <td>
      <h4>Developers</h4>
      <ul>
        <li>5% Fees</li>
        <li>PCI Compliance</li>
        <li>Millions of buyers</li>
      </ul>
      </td>

      <td>
      <h4>Buyers</h4>
      <ul>
        <li>One account for payments</li>
        <li>Pay with a few clicks</li>
        <li>Private payment credentials</li>
      </ul>
      </td>
    </tr>
    </tbody></table>
  </div>
  </article>

  <!-- API Flow -->
  <article class="">
  <h3>
    API flow
  </h3>
  <div>
    <img class="centered" src="./images/apiflow.png" width="800px" style="margin-top:5%; margin-left:-1%">
  </div>
  </article>

  <!-- ACCOUNT INFO -->
  <article class="">
  <h3>
    Before integrating
  </h3>
  <table class="noborder">
    <tbody><tr>
    <td>
  <p>
    </p><ul>
    <li>Sign up as a seller</li>
    <li>Get your <strong>Seller Id</strong></li>
    <li>Get your <strong>Seller Key</strong></li>
    <li>Configure your postback URL</li>
    </ul>
  <p></p>
  </td>
  <td>
   <img style="margin-top:15%" src="./images/accountinfo.png" width="450px" class="boxshadow">
  </td>
  </tr></tbody></table>
  </article>

    <!-- ITEM JWT -->
  <article class="smaller">
    <h3>Define item</h3>
    <pre>
{
  "iss" : 1337133713371337,
  "aud" : "Google"
  "typ" : "google/payments/inapp/item/v1",
  "exp" : "1392348430",
  "iat" : "1392282180",
  "request" :{
    "name" : "Piece of Cake",
    "description" : "Virtual chocolate cake to fill your virtual tummy",
    "price" : "10.50",
    "currencyCode" : "USD",
    "sellerData" : "user_id:1224245,offer_code:3098576987"
  }
}
</pre>
  </article>

  <!-- Create JWT in Python-->
  <article class="">
    <h3>Create JWT</h3>
    <p>Python:</p>
    <pre>
cakeJwt = jwt.encode(item, "1ZRJNFIOSJSIDFJNVHF");
</pre>
    <p>Ruby:</p>
<pre>
@cakeJwt = JWT.encode(item, "1ZRJNFIOSJSIDFJNVHF")
</pre>
  </article>


  <!-- INCLUDE JAVASCRIPT-->
  <article>
    <h3>Include JavaScript</h3>
    <pre>
&lt;script type="text/javascript" src="//www.google.com/jsapi">&lt;/script>
&lt;script>
  google.load('payments', '1.0', {
  'packages': ['sandbox_config']
  });
&lt;/script>
</pre>
  </article>

  <!-- DEFINE ITEM & ATTACH ACTION -->
  <article>
    <h3>Define JavaScript purchase handler</h3>
    <pre>
function purchase() {
  ...
  goog.payments.inapp.buy({
    'jwt'     : cakeJwt,
    'success' : successHandler,
    'failure' : failureHandler
  });
}
</pre>
    Create purchase button
    <pre>
&lt;button onclick="purchase()">Buy&lt;/button&gt;
</pre>
  </article>

  <!-- DEFINE HANDLER -->
  <article>
    <h3>Define postback handler</h3>
    <p>Python:</p>
    <pre>
def post(self):
encoded_jwt = self.request.get('jwt', None)
if encoded_jwt is not None:
  decoded_jwt = jwt.decode(str(encoded_jwt), SELLER_SECRET)
  order_id = decoded_jwt['response']['orderId']
  self.response.out.write(order_id)
</pre>
  <button onclick="purchase();">Buy</button>
  </article>
  <script>
  (function() {
    window.purchase = function() {
      alert('not impl');
    };
  })();
  </script>

  <!-- Integration Solutions -->
  <article>
  <h3>Tying information together</h3>
  <ul>
    <li>Use the sellerData parameter to hold user identification data</li>
    <li>Encrypt sellerData to protect user info</li>
    <li>Example: Identifying users - <br>
      sellerData = encrypt('user_id: 12345')</li>
    <li>Example: Identifying context - <br>
      sellerData = encrypt('sale: "happy hour"')</li>
    </ul>
  <p></p>
  </article>

  <!-- CHECKOUT APIS -->
  <article>
    <h3>
      Next steps
    </h3>
    <div class="build" style="margin-top:40px">
      <div class="to-build">
        <h4 style="margin-top:0px; margin-bottom:0px">Integrate</h4>
        <ul style="margin-top:5px; margin-bottom:20px">
          <li>Sign up as a seller:<br>
            http://sandbox.google.com/checkout/inapppayments</li>
          <li>Review the documentation:<br>
            http://code.google.com/apis/inapppayments</li>
        </ul>
      </div>
      <div class="to-build">
      <h4 style="margin-top:0px; margin-bottom:0px">Talk to other developers</h4>
      <ul style="margin-top:5px; margin-bottom:20px">
        <li>In-App Payments Forum<br>
          http://groups.google.com/group/in-app-payments</li>
      </ul>
      </div>
      <div class="to-build">
        <h4 style="margin-top:0px; margin-bottom:0px">Switch to Production</h4>
         <ul style="margin-top:5px; margin-bottom:20px">
            <li>Production signup<br>
              https://checkout.google.com/inapppayments/</li>
          </ul>
      </div>
    </div>
  </article>

  <article class="nobackground">
    <h3>Q&amp;A </h3>
    <div>
      <img class="centered" src="./images/qascreen.png" width="800px" style="margin-top:5%; margin-left:-1%">
    </div>
  </article>

  <article>
    <h3>Resources</h3>
    <ul>
      <li>Chrome's <a href="http://code.google.com/chrome/devtools/" target="_blank">DevTools</a> - invaluable</li>
      <li><a href="http://www.html5rocks.com" target="_blank">html5rocks.com</a> - learn by tutorial</li>
      <li><a href="http://html5boilerplate.com/" target="_blank">HTML5 Boilerplate</a>  and <a href="http://www.modernizr.com/" target="_blank">Modernizr</a> - foundation</li>
      <li><a href="http://caniuse.com" target="_blank">caniuse.com</a> - compatibility tables</li>
      <li>Google <a href="http://code.google.com/chrome/chromeframe/" target="_blank">Chrome Frame</a> - plugin. Brings Chrome to IE6-9</li>
      <li>Twitter: <a href="http://twitter.com/ChromiumDev" target="_blank">@ChromiumDev</a></li>
    </ul>
  </article>

  <article class='biglogo'></article>

  <script src="dnd-lib.js"></script>
</body>
</html>
