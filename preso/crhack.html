<!DOCTYPE html>
<!--
Copyright 2011 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Author: Eric Bidelman (ericbidelman@chromium.org),
        Boris Smus
        Ernest Delgado
        Pete LePage
        Peng Ying
-->
<html>
<head>
  <title>HTML5 Web App Hackathon</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <script src="slides.js"></script>
  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
  <script>
    google.load('payments', '1.0', {
    'packages': ['sandbox_config']
    });
  </script>
  <script type="text/javascript">
    var body = "eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiIwMDc5MDIyNTczNTc3N" + 
             "jYxMjQ0MCIsImF1ZCI6Ikdvb2dsZSIsInR5cCI6Imdvb2dsZS9" + 
             "wYXltZW50cy9pbmFwcC9pdGVtL3YxIiwiaWF0IjoxMzEyMDUyN" + 
             "zQ3LCJleHAiOjEzMTIxMzkxNDcsInJlcXVlc3QiOnsiY3VycmV" + 
             "uY3lDb2RlIjoiVVNEIiwicHJpY2UiOiI1LjAwIiwibmFtZSI6I" + 
             "kF2YXRhciIsInNlbGxlckRhdGEiOiJIdG1sNSIsImRlc2NyaXB" + 
             "0aW9uIjoiQXZhdGFyIn19.Ex9yWaSPk_QcFlZlOa8kHNFFJwXA" + 
             "eKlxV7e43KIkMoU";
    function buy(){
      goog.payments.inapp.buy({
        'jwt': body,
        'success': successHandler,
        'failure': failureHandler
      });
    }
    var successHandler = function(notification){
      $('#output').text(JSON.stringify(notification))
    }
    var failureHandler = function(notification){
      $('#output').text(JSON.stringify(notification));
    }
  </script>
  
  <style type="text/css">
    .principle {
      width: 700px;
      border-radius: 25px;
      padding: 25px;
      color: #eee;
      margin-left: auto;
      margin-right: auto;
      margin-top: 225px;
      background: #4c4c4c; /* Old browsers */
      background: -moz-linear-gradient(top, #4c4c4c 0%, #595959 12%, #666666 25%, #474747 39%, #2c2c2c 50%, #000000 51%, #111111 60%, #2b2b2b 76%, #1c1c1c 91%, #131313 100%); /* FF3.6+ */
      background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#4c4c4c), color-stop(12%,#595959), color-stop(25%,#666666), color-stop(39%,#474747), color-stop(50%,#2c2c2c), color-stop(51%,#000000), color-stop(60%,#111111), color-stop(76%,#2b2b2b), color-stop(91%,#1c1c1c), color-stop(100%,#131313)); /* Chrome,Safari4+ */
      background: -webkit-linear-gradient(top, #4c4c4c 0%,#595959 12%,#666666 25%,#474747 39%,#2c2c2c 50%,#000000 51%,#111111 60%,#2b2b2b 76%,#1c1c1c 91%,#131313 100%); /* Chrome10+,Safari5.1+ */
      background: -o-linear-gradient(top, #4c4c4c 0%,#595959 12%,#666666 25%,#474747 39%,#2c2c2c 50%,#000000 51%,#111111 60%,#2b2b2b 76%,#1c1c1c 91%,#131313 100%); /* Opera11.10+ */
      background: -ms-linear-gradient(top, #4c4c4c 0%,#595959 12%,#666666 25%,#474747 39%,#2c2c2c 50%,#000000 51%,#111111 60%,#2b2b2b 76%,#1c1c1c 91%,#131313 100%); /* IE10+ */
      filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#4c4c4c', endColorstr='#131313',GradientType=0 ); /* IE6-9 */
      background: linear-gradient(top, #4c4c4c 0%,#595959 12%,#666666 25%,#474747 39%,#2c2c2c 50%,#000000 51%,#111111 60%,#2b2b2b 76%,#1c1c1c 91%,#131313 100%); /* W3C */
    }
    
    .principle h4 {
      color: white;
      margin-top: 0px;
      margin-bottom: 10px;
    }
    
  </style>
</head>
<body style="display: none">

<section class='slides'>

  <!-- Your slides (<article>s) go here. Delete or comment out the
       slides below. -->

  <article class='biglogo'></article>

  <!-- INTRODUCTION -->
  <article id="title-slide">
    <h1>HTML5 Web App Hackathon <img src="images/HTML5_Badge_64.png" style="vertical-align:middle"></h1>
    <br>
    <p>
       Ernest Delgado, Pete LePage, Boris Smus<br>
       Mihai Ionescu, Peng Ying
    </p>
    <p>
      August 1-11, 2011 (NYC, CHI, KIR, MTV)
    </p>
  </article>

  <!-- Schedule -->
  <article>
    <h3>Schedule</h3>
    <p>
      <ul class="build">
        <li>12:00-1:30 - Lunch & Presentation</li>
        <li>1:30-2:00 - Pitches & Team organization</li>
        <li>2:00-7:00 - Hacking</li>
        <li>7:00-8:00 - Dinner & Finish hacking</li>
        <li>8:00-9:00 - Presentations, Voting & Prizes</li>
        </li>
      </ul>
    </p>
  </article>
  
  <!-- AGENDA -->
  <article>
    <h3>Agenda</h3>
    <p>
      <ul class="build">
        <li>Thinking web apps</li>
        <li>Introducing DJBreakPoint</li>
        <li>HTML5 makes building apps fun</li>
        <li>Messaging / realtime</li>
        <li>File APIs</li>
        <li>Audio hotness</li>
        <li>Monetization with In-App Payments</li>
        <li>Distribution using Chrome Web Store</li>
        </li>
      </ul>
    </p>
  </article>

  <!--
   *
   * Thinking web apps
   *
  -->
  <article class="fill">
    <h2>Thinking In Web Apps</h2>
  </article>

  <article class="fill">
    <img src="images/springpad.png">
    <div class="build">
      <div class="principle"><h4>Tight Focus</h4>A great web application has a tight focus encouraging people to <strong>interact</strong>, <strong>engage</strong>, and <strong>accomplish</strong> something, rather than passively view content.</div>
    </div>
    <!--<div class="source"><a href="http://bit.ly/p7G6IA">http://bit.ly/p7G6IA</a></div>-->
  </article>

  <article class="fill">
    <img src="images/gojee.png">
    <div class="build">
      <div class="principle"><h4>Provide Rich Visuals</h4>A great web application provides rich visuals that will <strong>delight the eye without distracting the mind.</strong></div>
    </div>
    <!--<div class="source"><a href="http://bit.ly/oZEqJh">http://bit.ly/oZEqJh</a></div>-->
  </article>
  
  <article class="fill">
    <img src="images/280slides.png">
    <div class="build">
      <div class="principle"><h4>Great User Experiences</h4>A great web application uses the <strong>latest web technologies</strong> enhance the user experience, so users can complete their work faster, easier and with confidence.</div>
    </div>
    <!--<div class="source"><a href="http://bit.ly/qSIzFl">http://bit.ly/qSIzFl</a></div>-->
  </article>

  <!--
   *
   * DJBreakpoint
   *
  -->
  <article class="centered">
    <h2>DJBreakpoint</h2>
    <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint">
    <p><a href="http://goo.gl/vyVol" target="_blank">http://goo.gl/vyVol</a></p>
  </article>

  <!--
   *
   * HTML5 makes building apps a breeze
   *
  -->
  <article class="fill">
    <h2>Building web apps - now a breeze</h2>
  </article>

  <article>
    <h3>CSS3: transitions/transforms/drop shadow/border radius</h3>
    <ul>
      <li>Techniques in the HTML4 era: DHTML transitions, Microsoft filters for transforms, repeated sprites for shadows, absolute image positioning for rounded corners.</li>
    </ul>
    <pre class="prettyprint">
   -moz-border-radius: 12px; /* FF1-3.6 */
-webkit-border-radius: 12px; /* Saf3-4, iOS 1-3.2, Android &lt;1.6 */
        border-radius: 12px; /* Opera 10.5, IE9, Saf5, Chrome,
                                FF4, iOS 4, Android 2.1+ */
</pre>
    <style> 
      #logo-container {
        font-size: 20px;
        color: #226;
        padding: 20px 0 50px;
        margin-bottom: 50px;
        text-align: center;
      }
      #logo-container:hover {
        -webkit-transform: rotate(-90deg);
        -webkit-transition: all 1s ease-in;
      }
    </style> 
      <pre><input id="web20-shadow" type="range" min="0" max="9" value="0" onchange="changeWeb20(event)"><input id="web20-gradient" type="range" min="0" max="100" value="0" onchange="changeWeb20(event)"> <input id="web20-border" type="range" min="0" max="50" value="0" onchange="changeWeb20(event)"> <input id="web20-reflect" type="range" min="0" max="100" value="0" onchange="changeWeb20(event)"></pre> 
        <div id="logo-container"> 
          <div id="web20-google"> 
            CSS3
          </div> 
        </div> 

    <script defer> 
      function changeWeb20() {
        var el = document.getElementById('web20-google');

        var textShadowVal = document.getElementById('web20-shadow').value;
        var gradientVal = document.getElementById('web20-gradient').value / 100;
        var borderVal = document.getElementById('web20-border').value;
        var reflectVal = document.getElementById('web20-reflect').value / 100;

        el.style.textShadow = 'rgba(0, 0, 0, 0.5) 0 ' + textShadowVal + 'px ' + textShadowVal + 'px';
        el.style.background = '-webkit-gradient(linear, left top, left bottom, from(rgba(200, 200, 240, ' + gradientVal + ')), to(rgba(255, 255, 255, ' + gradientVal + ')))';
        el.style.borderRadius = borderVal + 'px';
        el.style.webkitBoxReflect = 'below 10px -webkit-gradient(linear, left top, left bottom, from(transparent), to(rgba(255, 255, 255, ' + reflectVal + ')))';
      }
    </script>
  </article>

  <article>
    <h3>Web fonts</h3>
    <ul>
      <li>Techniques in the HTML4 era: Font Image Replacement</li>
    </ul>
    <pre class="prettyprint">
@font-face {
  font-family: 'WebFont';
  src: url('myfont.eot?#') format('eot'),  /* IE6–8 */
       url('myfont.woff') format('woff'),  /* FF3.6+, IE9, Chrome6+, 
                                              Saf5.1+*/
       url('myfont.ttf') format('truetype');  /* Saf3—5, Chrome4+, 
                                                 FF3.5, Opera 10+ */
}
</pre>
  <span style="font-family: Arial">Arial</span> <span style="font-family: Comic Sans MS">Comic Sans MS</span> <span style="font-family: Courier New">Courier New</span> <span style="font-family: Georgia">Georgia</span> <span style="font-family: Impact">Impact</span> <span style="font-family: Times New Roman">Times New Roman</span> <span style="font-family: Trebuchet MS">Trebuchet MS</span> <span style="font-family: Verdana">Verdana</span>
  </article>

  <article>
    <h3>classList/dataset</h3>
    <ul>
      <li>Techniques in the HTML4 era: custom Javascript for class manipulation, long class names to store application status</li>
    </ul>
    <pre class="prettyprint">
var el = document.querySelector('#main').classList;
el.add('highlight');
el.remove('shadow');
el.toggle('highlight');

&lt;div id="out" data-id="good" data-name="joe">&lt;/div>
document.querySelector('#out').dataset['name'] // joe
</pre>
  </article>

  <article>
    <h3>querySelectorAll(), querySelector()</h3>
    <ul>
      <li>Techniques in the HTML4 era: Walking the DOM or using external libraries</li>
    </ul>
    <pre class="prettyprint">var els = document.querySelectorAll("ul li:nth-child(odd)");
var tds = document.querySelectorAll("table.test > tr > td");
var el = document.querySelector("table.test > tr > td");
var els = document.getElementsByClassName('section');</pre>
  </article>

  <article>
    <style> 
      #box-orient-example {
        height: 260px;
        display: -webkit-box; -webkit-box-orient: horizontal;
        display: -moz-box; -moz-box-orient: horizontal;
      }
      #box-orient-example div:nth-child(1) {
        background: white; padding: 10px; -webkit-box-flex: 1; 
        -moz-box-flex: 1; text-align: center;
      }
      #box-orient-example div:nth-child(2) {
        background: #ddd; padding: 10px; -webkit-box-flex: 1; 
        -moz-box-flex: 1; text-align: center;
      }
      #box-orient-example div:nth-child(3) {
        background: white; padding: 10px; -webkit-box-flex: 3; 
        -moz-box-flex: 3; text-align: center;
      }
    </style>
    <h3>Page Layout with Flex Box</h3>
    <ul>
      <li>Techniques in the HTML4 era: negative margins, clearfix, tables!, hasLayout (zoom:1), Block Formatting Context</li>
    </ul>
    <pre>.box {
  display: -webkit-<b>box</b>;
  -webkit-<b>box-orient</b>: <select onchange='changeBoxOrient(event)'> 
      <option>horizontal</option> 
      <option>vertical</option> 
    </select>;
}
.box .one, .box .two {
  -webkit-<b>box-flex</b>: 1;
}
.box .three {
  -webkit-<b>box-flex</b>: 3;
}
</pre> 

    <div id="box-orient-example" class="example"> 
      <div> 
        Box one
      </div> 
      <div> 
        Box two
      </div> 
      <div> 
        Box three
      </div> 
    </div> 

    <script defer> 
      function changeBoxOrient(event) {
        var el = document.getElementById('box-orient-example');
        el.style.webkitBoxOrient = event.target.value;
        el.style.MozBoxOrient = event.target.value; 
      }
    </script> 
  </article>

  <article>
    <h3>HTML5 Drag and Drop</h3>
    <ul>
      <li>Techniques in the HTML4 era: Emulate drag events (cross browser!)</li>
    </ul>
    <pre class="prettyprint">
addEvent(drop, 'dragover', cancel);
addEvent(drop, 'dragenter', cancel);
addEvent(drop, 'drop', function (event) {
  // stops the browser from redirecting off to the text.
  if (event.preventDefault) {
    event.preventDefault();
  }
  this.innerHTML += '&lt;p>' + event.dataTransfer.getData('Text') + '&lt;/p>';
  return false;
});
</pre>

  </article>

  <article>
    <h3>Speech Input</h3>
    <pre>function startSearch(event) {
  if (event.target.<b>results</b>.length > 1) {
    var second = event.target.results[1].<b>utterance</b>;
    document.getElementById("second_best").value = second;
  }
  event.target.form.submit();
}</pre> 
    <input id="input-speech2" type="text" x-webkit-speech speech /> 
    <div style="text-align: left; font-size: 17px; height: 200px; overflow: auto; width: 500px; border: 1px solid black; padding: 10px" id="speech-results"> 

    </div> 
    <script> 
    document.getElementById("input-speech2").addEventListener("webkitspeechchange", function(event) {
      var speechresults = document.getElementById('speech-results');
      speechresults.innerHTML = '';
      for (var res in event.results) {
        speechresults.innerHTML += 'Utterance: ' + event.results[res]['utterance'] + '<br />Confidence: ' + event.results[res]['confidence'] + '<br /><br />';
      }
    }, false);
    </script>
  </article>

  <article>
    <h3>In DJBreakpoint <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint" class="small"> - Better Coded UI</h3>
    <p>Drag and Drop + Speech Input + Rounded Corners + CSS Gradients + CSS Tranforms + CSS Transitions + etc</p>
    <img style="margin-top: 40px" width="800px" src="images/boxes.png" />
  </article>

  <article>
    <h2>Messaging and Real Time Communication</h2>
  </article>

  <!--
    *
    * Web Sockets
    *
  -->
  <article>
    <h3>Web Sockets</h3>
    <ul>
      <li>Full-duplex, bi-directional communication over the web</li>
      <li>Low overhead (no HTTP headers)</li>
      <pre class="prettyprint">
var socket = new WebSocket('ws://html5rocks.websocket.org/echo');
socket.onmessage = function(event) { console.log(event.data); };
</pre>
    </ul>
  </article>

  <article>
    <h3>In DJBreakpoint <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint" class="small"> - Socket.IO</h3>
    <ul>
      <li>We use <a href="http://socket.io/">Socket.IO</a> to wrap around websockets.</li>
      <li>Client: connect to server and send msg</li>
<pre class="prettyprint">
var socket = io.connect('http://localhost');
socket.emit('message', {data: 'hello'})
socket.on('update', function(data) {
  console.log(data);
});
</pre>
      <li>Server: track clients and relay msgs</li>
<pre class="prettyprint">
var io = require('socket.io').listen(80);
io.sockets.on('message', function(socket) {
  socket.emit('update', {messages: messageBuffer});
});
</pre>
    </ul>
  </article>

  <!--
    *
    * Cross domain messaging
    *
  -->
  <article>
    <h3>Cross page messaging with <code>postMessage</code></h3>
    <ul>
      <li>Safely enabling cross-origin communication</li>
      <li>Sending a message</li>
      <pre class="prettyprint">
otherWindow.postMessage(message, targetOrigin);
</pre>
      <li>Receiving a message</li>
      <pre class="prettyprint">
window.addEventListener("message", function(event) {
  if (event.origin != "http://myurl.com/foo") { /* do stuff */ }
}, false);
</pre>
    </ul>
  </article>

  <article>
    <h3>In DJBreakpoint <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint" class="small"> - <code>postMessage</code></h3>
    <ul>
      <li>Chat implemented in a separate frame</li>
      <li>Chat frame sends message to parent:</li>
      <pre class="prettyprint">
socket_.on('chat', function(data) {
  window.parent.postMessage(data, document.location.origin);
}</pre>
      <li>Main frame listens for the event and renders bubble:</li>
      <pre class="prettyprint">
window.addEventListener('message', function(e) {
  document.querySelector('#dudes').append(createBubble(e.data));
});</pre>
    </ul>
  </article>


  <!--
   *
   * File APIs: INTRO
   *
  -->
  <article class="fill">
    <h2>File APIs</h2>
  </article>

  <!--
   *
   * File APIS: File
   *
  -->
  <article class="">
    <h3>Importing tunes</h3>
      <pre>&lt;input type="file" <b>accept="audio/*"</b> <b>multiple</b>&gt;</pre>
      <pre>
document.querySelector('input[type="file"]').onchange = function(e) {
  var files = <b>e.target.files</b>; // FileList

  for (var i = 0, f; f = files[i]; ++i) {
    // f.name
    // f.type // mimetype
    // f.size // bytes
    // f.lastModifiedDate.toLocaleDateString()
  }
};
</pre>
    <input type="file" id="filereader-files" multiple accept="audio/*"/>
    <output id="filereader-list"></output>
  </article>
  <script>
  (function() {
    document.querySelector('#filereader-files').onchange = function(e) {
      var files = e.target.files; // FileList

      var output = [];
      for (var i = 0, f; f = files[i]; ++i) {
        output.push('<li><b>', f.name, '</b> (',
            f.type || 'n/a', ') - ', f.size, ' bytes, last modified: ',
            f.lastModifiedDate.toLocaleDateString(), '</li>');
      }
      document.querySelector('#filereader-list').innerHTML =
          '<ul>' + output.join('') + '</ul>';
    };
  })();
  </script>

  <!--
   *
   * File APIs: Directory Upload
   *
  -->
  <article id="slide-dndfiles">
    <h3>Importing a directory of tunes</h3>
      <pre class="centered">&lt;input type="file" <b>webkitdirectory</b> /&gt;</pre>
      <ul>
        <li>Files in the <code>FileList</code> will have a <code>webkitRelativePath</code> property</li>
      </ul>
      <p><iframe class="noborder" src="http://www.htmlfivewow.com/demos/directory-upload/index.html" style="height:195px;"></iframe></p>
  </article>

  <!--
   *
   * File APIS: FileReader
   *
  -->
  <article>
    <h3>Reading file content</h3>
    <p>Asynchronously read binary data into memory:</p>
    <pre>
var reader = new <b>FileReader</b>();

reader.<b>readAsBinaryString</b>(File|Blob);

reader.<b>readAsText</b>(File|Blob, opt_encoding); // default UTF-8

reader.<b>readAsDataURL</b>(Blob|File);

reader.<b>readAsArrayBuffer</b>(Blob|File);</pre>
      <p>Reading byte ranges:</p>
      <pre>var blob = <b>file.webkitSlice</b>(startingByte, offset, opt_contentType);
reader.<b>readAsBinaryString</b>(blob);</pre>
  </article>

<!--
  <article>
    <h3>Monitoring things</h3>
      <pre>
reader.<b>onerror</b> = errorHandler;

reader.<b>onprogress</b> = updateProgress;

reader.<b>onabort</b> = cancelRead;

reader.<b>onloadstart</b> = updateProgress;

reader.<b>onloadend</b> = function(e) {
  // <b>e.target.readyState</b> == <b>FileReader.DONE</b> == 2
};

reader.onload = readFile;</pre>
  </article>
-->


  <!--
   *
   * File APIs: Drag and Drop File Access
   *
  -->
  <article id="slide-dndfiles">
    <h3>Importing tunes using drag &amp; drop</h3>
  <pre>var reader = new <b>FileReader</b>();
<b>reader.onload</b> = function(e) {
  document.querySelector('img').src = <b>e.target.result</b>;
};

function onDrop(e) {
  reader.<b>readAsDataURL</b>(<b>e.dataTransfer.files[0]</b>);
};</pre>
      <div>
        <div id="dropzone">
          Drop image files from your desktop
        </div>
      </div>
      <div id="thumbnails" class="hcenter"></div>
  </article>
  <script>
  document.addEventListener('DOMContentLoaded', function(e) {
    var dndc = new DNDFileController('dropzone');
  }, false);
  </script>

  <!--
   *
   * XHR2
   *
  -->
  <article class="fill">
    <h3>Uh oh...someone got a makeover!</h3>
    <img src="images/ajax.jpg">
  </article>

  <!--
   *
   * XHR2: Forms
   *
  -->
  <article>
    <h3>Sending form data</h3>
      <pre>
function submitForm() {
  var fd = new FormData(); // or prefill: FormData(window.myform)
  fd.append("username", "Groucho");
  fd.append("accountnum", 123456);

  // Append File. Creates a multipart/form-data upload.
  var file = document.querySelector('#afile').files[0];
  if (file) {
    fd.append('afile', file);
  }

  var xhr = new XMLHttpRequest();
  xhr.open('POST', '/upload', true);
  xhr.onload = function(e) { ... };
  xhr.send(fd);
}
</pre>
  </article>

  <!--
   *
   * XHR2: Blobs
   *
  -->
  <article>
    <h3>Uploading a file</h3>
      <pre>
function upload(blob, opt_callback) {
  var xhr = new XMLHttpRequest();
  xhr.open('POST', '/upload', true);
  if (opt_callback) {
    xhr.onload = opt_callback;
  }
  xhr.send(blob);
}

window.BlobBuilder = window.BlobBuilder ||
    window.WebKitBlobBuilder || window.MozBlobBuilder;

var bb = new BlobBuilder(); // Create a .txt file on the fly.
bb.append('Hello World');

uploadFile(bb.getBlob('text/plain'), function(e) {
  console.log('upload complete');
});
</pre>
  </article>

  <!--
   *
   * In DJBreakpoint
   *
  -->
  <article class="smaller">
    <h3>In DJBreakpoint <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint" class="small"> - DJ uploads a song</h3>
    <ul>
      <li>Server delegates DJ's turn using round robin.</li>
      <li>If turn && songs in queue: pull file from queue and upload using XHR2.</li>
      <li>Otherwise, tell server to try someone else.</li>
    </ul>
<pre>
uploadNextSong: function(el) {
  if (USER_FILE_QUEUE.length) {
    el.textContent = 'Uploading your file...';

    var formData = new FormData();
    formData.append('file', USER_FILE_QUEUE.shift());

    var xhr = new XMLHttpRequest();
    xhr.open('POST', '/upload', true);
    xhr.onload = function(e) { el.textContent = 'Uploading complete.'; };
    xhr.send(formData); // Upload entire song.
  } else {
    setTimeout(function() {
      el.textContent = 'No songs selected! Skipping you.';
      socket.json.emit('nextuser', {}); // Tell server to try next user.
    }, 3000);
  }
}
</pre>
  </article>

  <!--
   *
   * XHR2: Downlading
   *
  -->
  <article>
      <h3>Downloading a file</h3>
        <pre>
function download(url, callback) {
  var xhr = new XMLHttpRequest();
  xhr.open('GET', url, true);

  <b>xhr.responseType = 'arraybuffer';</b> // A raw buffer of bytes.

  xhr.onload = function(e) {
    callback(this, <b>this.response</b>); // Note: not xhr.responseText
  };
  xhr.send();
}

download('song.mp3', function(xhr, arrayBuffer) {
  // Create a file.
  var bb = new BlobBuilder();
  bb.append(arrayBuffer);
  var blob = bb.getBlob('audio/mpeg');
});
</pre>
  </article>

  <!--
   *
   * In DJBreakpoint
   *
  -->
  <article class="smaller">
    <h3>In DJBreakpoint <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint" class="small"> - listeners sent a download msg</h3>
    <ul>
      <li>When DJ's song upload is complete, download link is sent to listeners using websockets.</li>
      <li>On <code>startsong</code> event, connected listeners download the song using XHR2.</li>
    </ul>
<pre>
this.socket.on('startsong', function(file) {
  ...
  fetchSong_(file.url, file.name);
});

var fetchSong_ = function(url, name) {
  sm_ = new SoundManager();
  sm_.load(url, function(audioBuffer, arrayBuffer) {
    // Display song title, artist, year.

    // Load audio buffer into visualizer, hit play, and start the visuals.
    visualizer.audioPlayer.loadAudioBuffer(audioBuffer);
    visualizer.audioPlayer.play();
    visualizer.startVisuals();
  });
};
</pre>
  </article>

  <article class="smaller">
    <h3>Typed Arrays</h3>
    <ul>
      <li><code>ArrayBuffer</code> - chunk of bytes in memory. Create "views" from it:
        <ul>
          <li><code>Int8Array</code>, <code>Uint8Array</code></li>
          <li><code>Int16Array</code>, <code>Uint16Array</code></li>
          <li><code>Int32Array</code>, <code>Uint32Array</code></li>
          <li><code>Float32Array</code>, <code>Float64Array</code></li>
        </ul>
      </li>
      <li>Multiple representations can be created from a single <code>ArrayBuffer</code> source:
        <pre>
var uInt8Array = new Uint8Array(arrayBuffer);
var byte3 = uInt8Array[4]; // byte at offset 4.
var uInt32Array = new Uint32Array(arrayBuffer);
</pre>
      </li>
      <li><code>ArrayBufferView</code> - view of a portion of an <code>ArrayBuffer</code></li>
      <li><code>DataView</code> - an <code>ArrayBufferView</code> that understands endianness:
      <pre>
var data = new DataView(arrayBuffer);
var byte3 = data.getUint8(4);
var i = data.getInt32(0, false); // Big-endian
</pre>
      </li>
    </ul>
  </article>

  <!--
   *
   * Typed Arrays
   *
  -->
  <article class="smaller">
    <h3>In DJBreakpoint <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint" class="small"> - displaying song's ID3v1 info</h3>
    <ul>
      <li>MP3's ID3v1 tags read using <code>FileReader</code>, and "parsed" used <code>DataView</code>
      according to <a href="http://en.wikipedia.org/wiki/ID3" target="_blank">http://en.wikipedia.org/wiki/ID3</a>.</li>
      <li><a href="https://github.com/vjeux/jsDataView/" target="_blank">jsDataView</a> - awesome wrapper for <code>DataView</code></li>
    </ul>
<pre>
var dv = new jDataView(arrayBuffer);

// "TAG" starts at byte -128 from EOF.
if (dv.getString(3, dv.length - 128) == 'TAG') {
  var title = dv.getString(30, dv.tell()).trim();
  var artist = dv.getString(30, dv.tell()).trim();
  var album = dv.getString(30, dv.tell()).trim();
  var year = dv.getString(4, dv.tell()).trim();
  boothHeader_.textContent = [
      artist, '-', title, year ? '(' + year + ')' : ''].join(' ');
} else {
  boothHeader_.textContent = name; // Just use filename.
}

</pre>
  </article>

  <article>
    <h2>Audio hotness</h2>
  </article>

  <!--
   *
   * Audio hotness
   *
  -->

  <article>
    <h3>Web Audio API</h3>
    <ul>
      <li>Audio tag brings flashless audio and limitations</li>
      <li>Single channel, no access to raw stream</li>
      <li>WebAudio: powerful API to process and synthesize sound in web apps</li>
<pre>
context = new webkitAudioContext();
source = context.createBufferSource();
analyser = context.createAnalyser();
source.connect(analyser);
analyser.connect(context.destination);
</pre>
    </ul>
  </article>

  <article>
    <h3>In DJBreakpoint <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint" class="small"> - playing tunes</h3>
    <ul>
      <li>Loading mp3 via XHR2</li>
<pre>
var xhr = new XMLHttpRequest();
xhr.open("GET", url, true);
xhr.responseType = "arraybuffer";

xhr.addEventListener('load', function() {
  var buffer = context.createBuffer(xhr.response, false);
});
xhr.send();

</pre>
      <li>Getting raw data out:</li>
<pre>
analyser.getByteFrequencyData(freqs);
</pre>
    </ul>
  </article>

  <article>
    <h3>Interlude: Visualization with HTML5 Canvas</h3>
    <ul>
      <li>Canvas a simple 2D immediate mode drawing library</li>
      <li>Painters model</li>
    </ul>
<pre>
  var canvas = document.getElementById('a');
  var context = canvas.getContext('2d');
  context.fillRect(50, 25, 150, 100);
</pre>
    <p>Use <code>requestAnimationFrame</code> for render callbacks:</p>
<pre>

</pre>
  </article>

  <article>
    <h3>In DJBreakpoint <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint" class="small"> - visualization</h3>
    <ul>
      <li>Using ByteFrequencyData from WebAudio API</li>
      <li>Plotting frequency graph of the music that's playing</li>
<pre>
for (var i = 0; i < NUM_BINS + 1; ++i) {
  var value = freqs[i * width];
  var percent = value / 256;
  var height = NUM_BINS * percent;
  drawContext.fillStyle = 'hsl(' + computedColor + ', 100%, 50%)';
  drawContext.fillRect(...);
}
</pre>
    </ul>
  </article>

  <article>
    <h3>In DJBreakpoint <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint" class="small"> - beat detection</h3>
    <ul>
      <li>Feeding signal into an external library to get beat</li>
      <li>Using CSS3 animations to animate avatars</li>
<pre>
this.dancingImages[i].style.webkitTransform =
  'scale(' + scaleX + ',' + scaleY + ') skewX(' + skewAngle + 'rad)';
</pre>
    </ul>
  </article>

  <!--
   *
   * Monetization / Distribution
   *
  -->
  <article class="fill">
    <h2>Monetization</h2>
  </article>

  <!-- Demo -->
  <article>
    <h3>In DJBreakpoint <img src="../app/img/dj-working.png" alt="DJBreakpoint" title="DJBreakpoint" class="small"> - IAP</h3>
    <pre>
context.buy = function (item){
xhr.open(&#x27;POST&#x27;, window.location.href + &#x27;buy&#x27;, true);
xhr.onreadystatechange = function(jwt){
  if(xhr.readyState == 4){
    if(xhr.status == 200){
      goog.payments.inapp.buy({
        &#x27;jwt&#x27; : xhr.responseText,
        &#x27;success&#x27; : successHandler,
        &#x27;failure&#x27; : failureHandler
      });
    }
    else{
      console.log(&quot;error&quot; + xhr.status)
    }
  }
}
    </pre>
    
  </article>
  
  <!-- Transaction growth -->
   <article>
   <h3>
     Transaction Growth
   </h3>
  <div>
    <img class="centered" src="./images/payments_growth.png" width="800px" style="margin-top:5%; margin-left:-1%">
  </div>
   </article>  
  
  <!-- USERS -->
  <!--
   <article>
   <h3>
     Transaction growth
   </h3>
   <div>
     <div class="usersbooks">
     Books<br>
     <img src="./images/books.png" height="125">
     </div>
     <div class="usersyoutube">
     YouTube<br>
     <img src="./images/youtube.png" height="125">
     </div>
     <div class="userscws">
     Chrome<br>
     Web Store<br>
     <img src="./images/cws.png" height="125">
     </div>
     <div class="usersandroidmarket">
     Android Market<br>
     <img src="./images/androidmarket.png" height="125">
    </div>
     <div style="margin-top:13%;">
     <img class="centered" src="./images/growthgraph.png">
     </div>
   </div>
   </article>
-->

  <!-- Virtual Goods -->
  <article class="">
  <h3>
    Virtual Goods & Micro Payments
  </h3>
  <table class="noborder">
    <tbody><tr>
  <td>
   <img style="margin-top:25%; margin-left:-10%;" src="./images/piggy.jpg" width="430px">
  </td>
  <td>
   <img style="margin-top:30%;margin-left:-10%;" src="./images/vg_chart.png" width="390px">
  </td>
  </tr></tbody></table>
  </article>

  <!-- IAP BENEFITS -->
   <article class="">
  <h3>Benefits</h3>

  <div>
    <table class="noborder">
    <tbody><tr class="build">

      <td>
      <h4>Developers</h4>
      <ul>
        <li>Flat fee (5%) </li>
        <li>PCI Compliance </li>
        <li>Millions of buyers</li>
      </ul>
      </td>
      
      <td>
      <h4>Buyers</h4>
      <ul>
        <li>One account for payments</li>
        <li>Pay with a few clicks</li>
        <li>Private payment credentials</li>
      </ul>
      </td>

    </tr>
    </tbody></table>
  </div>
  </article>

  <!-- In-App Payments - The Big Picture -->
  <article class="">
  <h3>
    In-App Payments - The Big Picture
  </h3>
  <div>
    <img class="centered" src="./images/iap_recap.png" width="800px" style="margin-top:10%; margin-left:0%">
  </div>
  </article>
  
  <!-- User Flow -->
  <article class="">
  <h3>
    User: Click, Pay, Use
  </h3>
  <div>
    <img class="centered" src="./images/user_flow.png" width="800px" style="margin-top:20%; margin-left:-1%">
  </div>
  </article>

  <!-- Developer Pay Flow -->
  <article class="">
  <h3>
    Developer: Monetize in Two Calls
  </h3>
  <div>
    <img class="centered" src="./images/dev_pay_flow.png" width="800px" style="margin-top:15%; margin-left:-1%">
  </div>
  </article>

  <!-- API Flow -->
  <article class="">
  <h3>
    API Flow - Full Picture
  </h3>
  <div>
    <img class="centered" src="./images/apiflow.png" width="800px" style="margin-top:5%; margin-left:-1%">
  </div>
  </article>

  <!-- ACCOUNT INFO -->
  <article class="">
  <h3>
    Before Integrating
  </h3>
  <table class="noborder">
    <tbody><tr>
    <td>
  <p>
    </p><ul>
    <li>Sign up as a seller</li>
    <li>Get your <strong>Seller Id</strong></li>
    <li>Get your <strong>Seller Key</strong></li>
    <li>Configure your postback URL</li>
    </ul>
  <p></p>
  </td>
  <td>
   <img style="margin-top:15%" src="./images/accountinfo.png" width="450px" class="boxshadow">
  </td>
  </tr></tbody></table>
  </article>

    <!-- ITEM JWT -->
  <article class="smaller">
    <h3>Define Item for Sale</h3>
    <pre>
{
  "iss" : "1337133713371337",
  "aud" : "Google",
  "typ" : "google/payments/inapp/item/v1",
  "exp" : "1392348430",
  "iat" : "1392282180",
  "request" :{
    "name" : "Piece of Cake",
    "description" : "Virtual chocolate cake to fill your virtual tummy",
    "price" : "10.50",
    "currencyCode" : "USD",
    "sellerData" : "user_id:1224245,offer_code:3098576987"
  }
}
</pre>
  </article>

  <!-- Create JWT in Python-->
  <article class="">
    <h3>Create JSON Web Token</h3>
    <p>Python:</p>
    <pre>
cakeJwt = jwt.encode(item, "1ZRJNFIOSJSIDFJNVHF");
</pre>
    <p>Ruby:</p>
<pre>
@cakeJwt = JWT.encode(item, "1ZRJNFIOSJSIDFJNVHF")
</pre>
  </article>


  <!-- INCLUDE JAVASCRIPT-->
  <article>
    <h3>Include JavaScript Library</h3>
    <pre>
&lt;script type="text/javascript" src="//www.google.com/jsapi">&lt;/script>
&lt;script>
  google.load('payments', '1.0', {
  'packages': ['sandbox_config']
  });
&lt;/script>
</pre>
  </article>

  <!-- DEFINE ITEM & ATTACH ACTION -->
  <article>
    <h3>Define JavaScript Purchase Handler</h3>
    <pre>
function purchase() {
  ...
  goog.payments.inapp.buy({
    'jwt'     : cakeJwt,
    'success' : successHandler,
    'failure' : failureHandler
  });
}
</pre>
    Create purchase button
    <pre>
&lt;button onclick="purchase()">Buy&lt;/button&gt;
</pre>
  </article>

  <!-- DEFINE HANDLER -->
  <article>
    <h3>Define Postback Handler</h3>
    <p>Python:</p>
    <pre>
def post(self):
encoded_jwt = self.request.get('jwt', None)
if encoded_jwt is not None:
  decoded_jwt = jwt.decode(str(encoded_jwt), SELLER_SECRET)
  order_id = decoded_jwt['response']['orderId']
  self.response.out.write(order_id)
    </pre>
    <pre id='output' style='height:5em;'>
    </pre>
  <button onclick="buy();">Buy</button>
  </article>

  <!-- Integration Solutions -->
  <article>
  <h3>Tying Information Together</h3>
  <ul>
    <li>Use the sellerData parameter to hold user identification data</li>
    <li>Encrypt sellerData to protect user info</li>
    <li>Example: Identifying users - <br>
      sellerData = encrypt('user_id: 12345')</li>
    <li>Example: Identifying context - <br>
      sellerData = encrypt('sale: "happy hour"')</li>
    </ul>
  <p></p>
  </article>

  <!-- The Web App Ecosystem 
  <article class="">
  <h3>
    The Web App Ecosystem
  </h3>
  <div>
    <img class="centered" src="./images/app_ecosystem.png" width="780px" style="margin-top:16%; margin-left:0%">
  </div>
  </article> -->
  
  <!-- CHECKOUT APIS
  <article>
    <h3>
      Next Steps
    </h3>
    <div class="build" style="margin-top:40px">
      <div class="to-build">
        <h4 style="margin-top:0px; margin-bottom:0px">Integrate</h4>
        <ul style="margin-top:5px; margin-bottom:20px">
          <li>Sign up as a seller:<br>
            http://sandbox.google.com/checkout/inapppayments</li>
          <li>Review the documentation:<br>
            http://code.google.com/apis/inapppayments</li>
        </ul>
      </div>
      <div class="to-build">
      <h4 style="margin-top:0px; margin-bottom:0px">Talk to other developers</h4>
      <ul style="margin-top:5px; margin-bottom:20px">
        <li>In-App Payments Forum<br>
          http://groups.google.com/group/in-app-payments</li>
      </ul>
      </div>
      <div class="to-build">
        <h4 style="margin-top:0px; margin-bottom:0px">Switch to Production</h4>
         <ul style="margin-top:5px; margin-bottom:20px">
            <li>Production signup<br>
              https://checkout.google.com/inapppayments/</li>
          </ul>
      </div>
    </div>
  </article> -->
  
  <!--
   *
   * Chrome Web Store
   *
  -->
  <article class="fill">
    <h2>Chrome Web Store Distribution</h2>
  </article>


  <!-- Chrome Web Store - take a look -->
  <article>
    <h3>
      Chrome Web Store - let's take a look
    </h3>
<p>
	<a href="https://chrome.google.com/webstore" target="blank">https://chrome.google.com/webstore</a>
</p>
<p> Or, click the icon on the New Tab Page</p>
<br>
<p> An online marketplace for web apps, Chrome extensions, and Chrome themes</p>
  </article>

  <article>
    <!-- Millions of users have a direct channel to your app! -->
    <h3>Chrome Web Store</h3>
    <p>Making complex things simple</p>
  </article>

  <article>
    <h3>Discovery</h3>
    <img src="images/webstore.png" width=700>
  </article>

  <article>
    <h3>Make it easy for users to buy apps</h3>
    <img src="images/buy.png" width=700>
  </article>

  <article>
    <h3>Make it easy for developers to find users</h3>
    <img src="images/launcher2.png" width=700>
  </article>

  <article>
    <h3>Distribution</h3>
    <img src="images/users.png" width=700>
  </article>

  <article>
    <h3>Make it easy for developers to sell apps</h3>
    <img src="images/pricing.png" width=700>
  </article>

  <!-- Why build apps? -->
  <article>
    <h3>
      Chrome Web Store
    </h3>
    <dl>
      <dt>Discovery</dt>
      <dd>Help users find great apps, extensions, and themes</dd>
      <dt>Distribution</dt>
      <dd>Help developers and brands reach and be discovered by users</dd>
      <dt>Revenue</dt>
      <dd>Help developers earn revenue from their apps via Chrome Web Store payments, third-party payments, or ads</dd>
    </dl>
  </article>

  <!-- Success Stories -->
  <article class="smaller">
    <h3>
      Success Stories
    </h3>
    <p>
      “We’ve seen almost 100% percent higher time of engagement from users originating from Chrome than all other web app users.”
      <span style="color: black; font-size: 12pt;"><br>Jeff Janer, Springpad co-founder</span>
    </p>
    <p>
      “The Chrome Web Store has turned out to be a great channel for acquiring really high-quality users who engage deeply with our app...”
      <span style="color: black; font-size: 12pt;"><br>Mike Sha, Wikinvest founder</span>
    </p>
    <p>
      “It’s not just that people are using the app—it’s that the Chrome audience appears to be highly qualified and engaged. The results have far exceeded our expectations.”
      <span style="color: black; font-size: 12pt;"><br>YuChiang Cheng, WGT.com founder</span>
    </p>
    <p>
      “We’ve subsequently seen a steady flow of leads, with as much as 60 percent of our new leads coming from the Chrome Web Store every day.”
      <span style="color: black; font-size: 12pt;"><br>Nat Robinson, SlideRocket VP of Marketing and Business Development</span>
    </p>
    <p>Read more: <a href="http://www.google.com/chrome/createanapp">http://www.google.com/chrome/createanapp</a>

  </article>
<!--
  <article class="nobackground">
    <h3>Q&amp;A </h3>
    <div>
      <img class="centered" src="./images/qascreen.png" width="800px" style="margin-top:5%; margin-left:-1%">
    </div>
  </article>-->

  <article lass="nobackground">
      <h3>chromestatus.com</h3>
      <iframe src='http://chromestatus.com'></iframe>
    </article>

    <article class="nobackground">
      <h3>updates.html5rocks.com</h3>
      <iframe src='http://updates.html5rocks.com'></iframe>
    </article>

  <article>
    <h3>Resources</h3>
    <ul>
      <li>Chrome's <a href="http://code.google.com/chrome/devtools/" target="_blank">DevTools</a> - invaluable</li>
      <li><a href="http://www.html5rocks.com" target="_blank">html5rocks.com</a> - learn by tutorial</li>
      <li><a href="http://google.com/payments">google.com/payments</a> - Payments signup & documentation
      </li>
      <li><a href="http://chrome.google.com/webstore">chrome.google.com/webstore</a> - Chrome Web Store
      </li>
      <li><a href>
      <li><a href="http://html5boilerplate.com/" target="_blank">HTML5 Boilerplate</a>  and <a href="http://www.modernizr.com/" target="_blank">Modernizr</a> - foundation</li>
      <li><a href="http://caniuse.com" target="_blank">caniuse.com</a> - compatibility tables</li>
      <li>Google <a href="http://code.google.com/chrome/chromeframe/" target="_blank">Chrome Frame</a> - plugin. Brings Chrome to IE6-9</li>
      <li>Twitter: <a href="http://twitter.com/ChromiumDev" target="_blank">@ChromiumDev @GoogCommerceDev</a></li>
    </ul>
  </article>

  <article class='biglogo'>
    <p class='centered' style='padding-top:400px'>Feedback: <a href="http://goo.gl/oTflp">goo.gl/oTflp</a></p>
  </article>

  <script src="dnd-lib.js"></script>
</body>
</html>
